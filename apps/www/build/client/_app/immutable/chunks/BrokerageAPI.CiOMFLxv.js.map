{"version":3,"file":"BrokerageAPI.CiOMFLxv.js","sources":["../../../../../../src/routes/playground/options-api/components/BrokerageAPI.svelte"],"sourcesContent":["<script lang=\"ts\">\n  import { formatOutputDate } from '$lib/utils';\n  import { Button } from '$lib/components/ui/button';\n  import { Input } from '$lib/components/ui/input';\n  import { Label } from '$lib/components/ui/label';\n  import { createBrokerage } from '$lib/wrappers';\n  import { Address, fromNano } from '@ton/core';\n  import Section from './Section.svelte';\n  import Output from '../../components/Output.svelte';\n\n  const brokerage = createBrokerage();\n\n  let output = $state<{ date: Date | string; message: string }[]>([]);\n\n  async function handleDeploySubmit(\n    e: SubmitEvent & {\n      currentTarget: EventTarget & HTMLFormElement;\n    }\n  ) {\n    e.preventDefault();\n\n    const formData = new FormData(e.currentTarget);\n    const args = {\n      queryId: BigInt(formData.get('queryId') as string)\n    };\n\n    await $brokerage.deploy(args);\n  }\n\n  async function handleDeployBrokerSubmit(\n    e: SubmitEvent & {\n      currentTarget: EventTarget & HTMLFormElement;\n    }\n  ) {\n    e.preventDefault();\n\n    const formData = new FormData(e.currentTarget);\n    const args = {\n      stream: Address.parse(formData.get('stream') as string),\n      queryId: BigInt(formData.get('queryId') as string)\n    };\n\n    await $brokerage.deployBroker(args);\n  }\n\n  async function handleDeployAccountSubmit(\n    e: SubmitEvent & {\n      currentTarget: EventTarget & HTMLFormElement;\n    }\n  ) {\n    e.preventDefault();\n\n    const formData = new FormData(e.currentTarget);\n    const args = {\n      queryId: BigInt(formData.get('queryId') as string)\n    };\n\n    await $brokerage.deployAccount(args);\n  }\n</script>\n\n<Section title=\"Brokerage\">\n  <p class=\"mb-8 mt-4 text-ds-gray-900 max-w-[640px]\">\n    Initializes brokerage accounts with the owner's address. Handles broker and account deployments,\n    ensuring sender authorization and required deposits. Retrieves associated broker and account\n    addresses and notifies deployment success. Tracks storage reserves and manages contract\n    interactions securely.\n  </p>\n  <div class=\"flex gap-4 items-end overflow-x-auto\">\n    <form class=\"flex flex-col gap-4 min-w-max\" onsubmit={handleDeploySubmit}>\n      <Label class=\"flex flex-col gap-2\"\n        >Query ID\n        <Input type=\"number\" name=\"queryId\" placeholder=\"777\" required min=\"0\" />\n      </Label>\n      <Button class=\"bg-ds-green-800 text-white hover:bg-ds-green-700\" type=\"submit\"\n        >Deploy Brokerage</Button\n      >\n    </form>\n\n    <form class=\"flex flex-col gap-4 w-max\" onsubmit={handleDeployBrokerSubmit}>\n      <Label class=\"flex flex-col gap-2\"\n        >Stream Address\n        <Input\n          type=\"text\"\n          name=\"stream\"\n          placeholder=\"0QAXeOTnpkBx_A6zKVxAYNDYqNuWPyrZkYZySJRZ_-zV4gLV\"\n          required\n          min=\"0\"\n        />\n      </Label>\n      <Label class=\"flex flex-col gap-2\"\n        >Query ID\n        <Input type=\"number\" name=\"queryId\" placeholder=\"777\" required min=\"0\" />\n      </Label>\n      <Button class=\"bg-ds-green-800 text-white hover:bg-ds-green-700\" type=\"submit\"\n        >Deploy Broker</Button\n      >\n    </form>\n\n    <form class=\"flex flex-col gap-4 w-max\" onsubmit={handleDeployAccountSubmit}>\n      <Label class=\"flex flex-col gap-2\"\n        >Query ID\n        <Input type=\"number\" name=\"queryId\" placeholder=\"777\" required min=\"0\" />\n      </Label>\n      <Button class=\"bg-ds-green-800 text-white hover:bg-ds-green-700\" type=\"submit\"\n        >Deploy Account</Button\n      >\n    </form>\n\n    <Button\n      class=\"bg-ds-blue-800 text-white hover:bg-ds-blue-700\"\n      onclick={async () => {\n        const result = await $brokerage.getOwner();\n        output.unshift({\n          date: formatOutputDate(new Date()),\n          message: JSON.stringify(result.toString({ testOnly: true, bounceable: false }), null, 2)\n        });\n      }}>Get Owner</Button\n    >\n\n    <form\n      class=\"flex flex-col gap-4 w-max\"\n      onsubmit={async (e) => {\n        e.preventDefault();\n\n        const formData = new FormData(e.currentTarget);\n\n        const result = await $brokerage.getBroker(Address.parse(formData.get('stream') as string));\n\n        output.unshift({\n          date: formatOutputDate(new Date()),\n          message: JSON.stringify(result.toString({ testOnly: true, bounceable: false }), null, 2)\n        });\n      }}\n    >\n      <Label class=\"flex flex-col gap-2\"\n        >Stream Address\n        <Input\n          type=\"text\"\n          name=\"stream\"\n          placeholder=\"0QAXeOTnpkBx_A6zKVxAYNDYqNuWPyrZkYZySJRZ_-zV4gLV\"\n          required\n          min=\"0\"\n        />\n      </Label>\n      <Button class=\"bg-ds-blue-800 text-white hover:bg-ds-blue-700\" type=\"submit\"\n        >Get Broker</Button\n      >\n    </form>\n\n    <form\n      class=\"flex flex-col gap-4 w-max\"\n      onsubmit={async (e) => {\n        e.preventDefault();\n\n        const formData = new FormData(e.currentTarget);\n\n        const result = await $brokerage.getAccount(Address.parse(formData.get('trader') as string));\n\n        output.unshift({\n          date: formatOutputDate(new Date()),\n          message: JSON.stringify(result.toString({ testOnly: true, bounceable: false }), null, 2)\n        });\n      }}\n    >\n      <Label class=\"flex flex-col gap-2\"\n        >Trader\n        <Input\n          type=\"text\"\n          name=\"trader\"\n          placeholder=\"0QAXeOTnpkBx_A6zKVxAYNDYqNuWPyrZkYZySJRZ_-zV4gLV\"\n          required\n          min=\"0\"\n        />\n      </Label>\n      <Button class=\"bg-ds-blue-800 text-white hover:bg-ds-blue-700\" type=\"submit\"\n        >Get Account</Button\n      >\n    </form>\n\n    <Button\n      class=\"bg-ds-blue-800 text-white hover:bg-ds-blue-700\"\n      onclick={async () => {\n        const result = await $brokerage.getStorageReserve();\n        output.unshift({\n          date: formatOutputDate(new Date()),\n          message: JSON.stringify(`${fromNano(result)} TON`, null, 2)\n        });\n      }}>Get Storage Reserve</Button\n    >\n  </div>\n\n  <Output bind:output />\n</Section>\n"],"names":["brokerage","createBrokerage","output","$.source","$.proxy","handleDeploySubmit","e","formData","args","$brokerage","handleDeployBrokerSubmit","Address","handleDeployAccountSubmit","result","$.get","formatOutputDate","fromNano"],"mappings":";;;6cAUQA,EAAYC,KAEd,IAAAC,EAAAC,GAAAC,EAAA,CAAA,CAAA,CAAA,iBAEWC,EACbC,EAAA,CAIAA,EAAE,eAAA,QAEIC,EAAe,IAAA,SAASD,EAAE,aAAa,EACvCE,EAAA,CACJ,QAAS,OAAOD,EAAS,IAAI,SAAS,CAAA,GAGlC,MAAAE,EAAA,EAAW,OAAOD,CAAI,iBAGfE,EACbJ,EAAA,CAIAA,EAAE,eAAA,QAEIC,EAAe,IAAA,SAASD,EAAE,aAAa,EACvCE,EAAA,CACJ,OAAQG,EAAQ,QAAA,MAAMJ,EAAS,IAAI,QAAQ,CAAA,EAC3C,QAAS,OAAOA,EAAS,IAAI,SAAS,CAAA,GAGlC,MAAAE,EAAA,EAAW,aAAaD,CAAI,iBAGrBI,EACbN,EAAA,CAIAA,EAAE,eAAA,QAEIC,EAAe,IAAA,SAASD,EAAE,aAAa,EACvCE,EAAA,CACJ,QAAS,OAAOD,EAAS,IAAI,SAAS,CAAA,GAGlC,MAAAE,EAAA,EAAW,cAAcD,CAAI,68CAuDzBK,EAAM,MAASJ,EAAU,EAAC,SAAQ,EACxCK,EAAAZ,CAAM,EAAC,QAAO,CACZ,KAAMa,EAAgB,IAAK,IAAI,EAC/B,QAAS,KAAK,UAAUF,EAAO,SAAQ,CAAG,SAAU,GAAM,WAAY,EAAK,CAAK,EAAA,KAAM,CAAC,27BAoEnFA,EAAM,MAASJ,EAAU,EAAC,kBAAiB,EACjDK,EAAAZ,CAAM,EAAC,QAAO,CACZ,KAAMa,EAAgB,IAAK,IAAI,EAC/B,QAAS,KAAK,UAAS,GAAIC,EAAAA,SAASH,CAAM,CAAA,OAAS,KAAM,CAAC,0JArHVR,EAAkB,EAAA,eAUtBK,EAAwB,EAAA,eAoBxBE,EAAyB,EAAA,qBAuBxD,GAAC,CAChB,EAAE,eAAc,EAEV,MAAAL,EAAe,IAAA,SAAS,EAAE,aAAa,EAEvCM,EAAe,MAAAJ,EAAW,EAAA,UAAUE,EAAAA,QAAQ,MAAMJ,EAAS,IAAI,QAAQ,CAAA,CAAA,EAE7EO,EAAAZ,CAAM,EAAC,QAAO,CACZ,KAAMa,EAAgB,IAAK,IAAI,EAC/B,QAAS,KAAK,UAAUF,EAAO,SAAQ,CAAG,SAAU,GAAM,WAAY,EAAK,CAAK,EAAA,KAAM,CAAC,4BAqB1E,GAAC,CAChB,EAAE,eAAc,EAEV,MAAAN,EAAe,IAAA,SAAS,EAAE,aAAa,EAEvCM,EAAe,MAAAJ,EAAW,EAAA,WAAWE,EAAAA,QAAQ,MAAMJ,EAAS,IAAI,QAAQ,CAAA,CAAA,EAE9EO,EAAAZ,CAAM,EAAC,QAAO,CACZ,KAAMa,EAAgB,IAAK,IAAI,EAC/B,QAAS,KAAK,UAAUF,EAAO,SAAQ,CAAG,SAAU,GAAM,WAAY,EAAK,CAAK,EAAA,KAAM,CAAC"}