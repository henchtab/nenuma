import{w as E,s as a,b as n,c as d}from"./index.mbo8UwIt.js";import{p as U}from"./this.BkV_1EO3.js";import{P as g}from"./context.CrttRzP-.js";import{t as m}from"./utils.DKZFuNm_.js";import"./disclose-version.u5Z3pXpL.js";(function(){try{var t=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},e=new Error().stack;e&&(t._sentryDebugIds=t._sentryDebugIds||{},t._sentryDebugIds[e]="2c5762f5-f06c-4ed3-88e6-20bf41823d8c",t._sentryDebugIdIdentifier="sentry-dbid-2c5762f5-f06c-4ed3-88e6-20bf41823d8c")}catch{}})();const p=1e3,l={send:()=>{console.error("WebSocket connection not established")},close:()=>{console.error("WebSocket connection not established")},addEventListener:()=>{console.error("WebSocket connection not established")},reconnect:()=>{console.error("WebSocket connection not established")},isConnected:!1,isError:!1,currentMessage:null},C=E(l,t=>{let e=d(null),i=d(!1),u=d(!1),f=d(null);function S(){var s,r,T;a(e,U(new WebSocket(`${g.replace("https","wss")}/api/kline`))),(s=n(e))==null||s.addEventListener("open",()=>{a(i,!0)}),(r=n(e))==null||r.addEventListener("message",o=>{const c=JSON.parse(o.data);c.data.time=m(c.data.time),a(f,U(c)),w.update(D=>(D[c.topic]=c.data.close,D))}),(T=n(e))==null||T.addEventListener("close",o=>{console.log(`WebSocket connection closed with code: ${o.code} and reason: ${o.reason}`),t(l)}),n(e).addEventListener("error",o=>{console.error("WebSocket error:",o),a(u,!0),t(l)}),t({send:n(e).send.bind(n(e)),close:n(e).close.bind(n(e)),addEventListener:n(e).addEventListener.bind(n(e)),reconnect:S,get isConnected(){return n(i)},get isError(){return n(u)},get currentMessage(){return n(f)}})}function b(){var s,r;((s=n(e))==null?void 0:s.bufferedAmount)===0?(r=n(e))==null||r.close(1e3,"User closed the connection"):setTimeout(b,p)}return S(),b});var L=(t=>(t.BTCUSDT="BTCUSDT",t.ETHUSDT="ETHUSDT",t.SOLUSDT="SOLUSDT",t.TONUSDT="TONUSDT",t.BNBUSDT="BNBUSDT",t))(L||{});const w=E({BTCUSDT:0,ETHUSDT:0,SOLUSDT:0,TONUSDT:0,BNBUSDT:0});export{L as K,w as l,C as w};
//# sourceMappingURL=ws.svelte.r0yWGkU9.js.map
