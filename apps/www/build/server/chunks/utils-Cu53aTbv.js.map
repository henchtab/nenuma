{"version":3,"file":"utils-Cu53aTbv.js","sources":["../../../../src/lib/utils.ts"],"sourcesContent":["import { browser } from '$app/environment';\nimport { clsx, type ClassValue } from 'clsx';\nimport { cubicOut } from 'svelte/easing';\nimport { readable } from 'svelte/store';\nimport type { TransitionConfig } from 'svelte/transition';\nimport { twMerge } from 'tailwind-merge';\nimport { TON_VALID_UNTIL } from './constants';\nimport { hapticFeedback } from './stores/tma';\n\nexport function cn(...inputs: ClassValue[]) {\n  return twMerge(clsx(inputs));\n}\n\nexport function pad(number: number) {\n  return number < 10 ? '0' + number : number;\n}\n\nexport function formatTime(date: Date) {\n  return `${pad(date.getHours())}:${pad(date.getMinutes())}`;\n}\n\nexport function timeToLocal(originalTime: number) {\n  const d = new Date(originalTime * 1000);\n  return (\n    Date.UTC(\n      d.getFullYear(),\n      d.getMonth(),\n      d.getDate(),\n      d.getHours(),\n      d.getMinutes(),\n      d.getSeconds(),\n      d.getMilliseconds()\n    ) / 1000\n  );\n}\n\n/**\n * Format date to the playground output console format\n *  @param date - Date object\n */\nexport function formatOutputDate(date: Date) {\n  const months = [\n    'JAN',\n    'FEB',\n    'MAR',\n    'APR',\n    'MAY',\n    'JUN',\n    'JUL',\n    'AUG',\n    'SEP',\n    'OCT',\n    'NOV',\n    'DEC'\n  ];\n\n  const month = months[date.getMonth()];\n  const day = String(date.getDate()).padStart(2, '0');\n  const hours = String(date.getHours()).padStart(2, '0');\n  const minutes = String(date.getMinutes()).padStart(2, '0');\n  const seconds = String(date.getSeconds()).padStart(2, '0');\n  const milliseconds = String(date.getMilliseconds()).padStart(3, '0').slice(0, 2);\n\n  return `${month} ${day} ${hours}:${minutes}:${seconds}.${milliseconds}`;\n}\n\ntype FlyAndScaleParams = {\n  y?: number;\n  x?: number;\n  start?: number;\n  duration?: number;\n};\n\nexport const flyAndScale = (\n  node: Element,\n  params: FlyAndScaleParams = { y: -8, x: 0, start: 0.95, duration: 150 }\n): TransitionConfig => {\n  const style = getComputedStyle(node);\n  const transform = style.transform === 'none' ? '' : style.transform;\n\n  const scaleConversion = (valueA: number, scaleA: [number, number], scaleB: [number, number]) => {\n    const [minA, maxA] = scaleA;\n    const [minB, maxB] = scaleB;\n\n    const percentage = (valueA - minA) / (maxA - minA);\n    const valueB = percentage * (maxB - minB) + minB;\n\n    return valueB;\n  };\n\n  const styleToString = (style: Record<string, number | string | undefined>): string => {\n    return Object.keys(style).reduce((str, key) => {\n      if (style[key] === undefined) return str;\n      return str + `${key}:${style[key]};`;\n    }, '');\n  };\n\n  return {\n    duration: params.duration ?? 200,\n    delay: 0,\n    css: (t) => {\n      const y = scaleConversion(t, [0, 1], [params.y ?? 5, 0]);\n      const x = scaleConversion(t, [0, 1], [params.x ?? 0, 0]);\n      const scale = scaleConversion(t, [0, 1], [params.start ?? 0.95, 1]);\n\n      return styleToString({\n        transform: `${transform} translate3d(${x}px, ${y}px, 0) scale(${scale})`,\n        opacity: t\n      });\n    },\n    easing: cubicOut\n  };\n};\n\nexport function mediaQuery(query: string) {\n  return readable(false, (set) => {\n    const _window = browser ? window : undefined;\n    const isSupported =\n      _window && 'matchMedia' in _window && typeof _window.matchMedia === 'function';\n\n    let mediaQuery: MediaQueryList | undefined;\n\n    function cleanup() {\n      if (!mediaQuery) return;\n      if ('removeEventListener' in mediaQuery) mediaQuery.removeEventListener('change', update);\n      // @ts-expect-error deprecated API\n      else mediaQuery.removeListener(update);\n    }\n\n    function update() {\n      if (!isSupported) return;\n\n      cleanup();\n\n      mediaQuery = _window!.matchMedia(query);\n      set(mediaQuery.matches);\n\n      if ('addEventListener' in mediaQuery) mediaQuery.addEventListener('change', update);\n      // @ts-expect-error deprecated API\n      else mediaQuery.addListener(update);\n    }\n\n    update();\n\n    return cleanup;\n  });\n}\n\nexport function randomize() {\n  const uns = hapticFeedback.subscribe((f) => {\n    if (f) f.impactOccurred('light');\n  });\n\n  setTimeout(() => {\n    uns();\n  }, 1000);\n\n  return Math.floor(Math.random() * 10000);\n}\n\nexport function getValidUntil() {\n  return Math.floor(Date.now() / 1000) + TON_VALID_UNTIL;\n}\n"],"names":[],"mappings":"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"}