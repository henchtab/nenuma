{"version":3,"file":"ton-connect-Dy4dENFp.js","sources":["../../../../src/lib/stores/ton-connect.ts","../../../../../../node_modules/.pnpm/svelte@5.0.0-next.166/node_modules/svelte/src/index-server.js"],"sourcesContent":["import { THEME, TonConnectUI, Wallet } from '@tonconnect/ui';\nimport { Writable, derived, readable, writable } from 'svelte/store';\nimport { browser } from '$app/environment';\nimport type { SenderArguments } from '@ton/core';\n\nexport const tonConnectUI = readable<TonConnectUI>(undefined, (set) => {\n  const update = () => {\n    if (!browser) return;\n\n    const sdk = new TonConnectUI({\n      manifestUrl: 'https://nenuma.telegram-mini-apps.manuvantara.com/tonconnect-manifest.json',\n      widgetRootId: 'ton-connect',\n      uiPreferences: {\n        theme: THEME.DARK\n      }\n    });\n\n    set(sdk);\n  };\n\n  update();\n\n  return () => {\n    if (browser) {\n      const el = document.getElementById('ton-connect');\n\n      if (el) {\n        el.innerHTML = '';\n        console.log('tonConnectUI cleanup');\n      }\n    }\n  };\n});\n\ntype TonConnect = {\n  sdk: TonConnectUI | null;\n  connection: {\n    status: 'reconnecting' | 'connected' | 'disconnected';\n    wallet: Wallet | null;\n  };\n  connectWallet: () => Promise<void>;\n  disconnectWallet: () => Promise<void>;\n};\n\nexport type TonConnectStore = Writable<TonConnect>;\n\nexport const tonConnect = writable<TonConnect>({\n  sdk: null,\n  connection: {\n    status: 'reconnecting',\n    wallet: null\n  },\n  connectWallet: async () => {},\n  disconnectWallet: async () => {}\n});\n\nexport const isReconnecting = derived(\n  tonConnect,\n  ($tonConnect) => $tonConnect.connection.status === 'reconnecting'\n);\nexport const isConnected = derived(\n  tonConnect,\n  ($tonConnect) => $tonConnect.connection.status === 'connected'\n);\n\nexport const isDisconnected = derived(\n  tonConnect,\n  ($tonConnect) => $tonConnect.connection.status === 'disconnected'\n);\n\nexport const sender = derived(tonConnectUI, ($tonConnectUI) => {\n  return {\n    send: async (args: SenderArguments) => {\n      $tonConnectUI.sendTransaction({\n        messages: [\n          {\n            address: args.to.toString(),\n            amount: args.value.toString(),\n            payload: args.body?.toBoc().toString('base64')\n          }\n        ],\n        validUntil: Date.now() + 5 * 60 * 1000\n      });\n    },\n    connected: $tonConnectUI.connected\n  };\n});\n","import { current_component } from './internal/server/context.js';\nimport { noop } from './internal/shared/utils.js';\nimport * as e from './internal/server/errors.js';\n\n/** @param {() => void} fn */\nexport function onDestroy(fn) {\n\tvar context = /** @type {import('#server').Component} */ (current_component);\n\t(context.d ??= []).push(fn);\n}\n\nexport {\n\tnoop as beforeUpdate,\n\tnoop as afterUpdate,\n\tnoop as onMount,\n\tnoop as flushSync,\n\trun as untrack\n} from './internal/shared/utils.js';\n\nexport function createEventDispatcher() {\n\treturn noop;\n}\n\nexport function mount() {\n\te.lifecycle_function_unavailable('mount');\n}\n\nexport function hydrate() {\n\te.lifecycle_function_unavailable('hydrate');\n}\n\nexport function unmount() {\n\te.lifecycle_function_unavailable('unmount');\n}\n\nexport async function tick() {}\n\nexport { getAllContexts, getContext, hasContext, setContext } from './internal/server/context.js';\n"],"names":[],"mappings":";;;;;;;;;;;;ACKO,SAAS,SAAhB,CAA0B,EAA1B,EAA8B;AAC7B,EAAD,IAAK,OAAL;AAAK;AAAA,IAAsD,iBAA3D;AAA2D,GAA3D,CAAA;AACC,EAAD,CAAE,OAAF,CAAU,CAAV,KAAgB,EAAhB,EAAoB,IAApB,CAAyB,EAAE,CAA3B,CAAA;AACA,CAAA;AA0BO,eAAe,IAAtB,GAA6B;AAAA,CAA7B;AD7BA,MAAa,YAAb,GAA4B,QAA5B,CAAmD,KAAnD,CAAA,EAA8D,CAAC,GAA/D,KAAuE;AAiBrE,EAAF,OAAS,MAAM;AAAA,GAAf,CAAA;AAUA,CAAC,EAAD;AAcA,MAAa,UAAb,GAA0B,QAA1B,CAA+C;AAAA,EAC7C,GADF,EACO,IADP;AACO,EACL,UADF,EACc;AAAA,IACV,MADJ,EACY,cADZ;AACY,IACR,MADJ,EACY,IADZ;AACY,GAAZ;AACE,EACA,aADF,EACiB,YAAY;AAAA,GAA7B;AAA8B,EAC5B,gBADF,EACoB,YAAY;AAAA,GAAhC;AACA,CAAC,EAAD;AAEA,MAAa,cAAb,GAA8B,OAA9B;AAA8B,EAC5B,UADF;AACE,EACA,CAAC,WADH,KACmB,WADnB,CAC+B,UAD/B,CAC0C,MAD1C,KACqD,cADrD;AAEA,EAAA;AACA,MAAa,WAAb,GAA2B,OAA3B;AAA2B,EACzB,UADF;AACE,EACA,CAAC,WADH,KACmB,WADnB,CAC+B,UAD/B,CAC0C,MAD1C,KACqD,WADrD;AAEA,EAAA;AAE8B,OAA9B;AAA8B,EAC5B,UADF;AACE,EACA,CAAC,WADH,KACmB,WADnB,CAC+B,UAD/B,CAC0C,MAD1C,KACqD,cADrD;AAEA,CAAA,CAAA;AAEA,MAAa,MAAb,GAAsB,OAAtB,CAA8B,YAA9B,EAA4C,CAAC,aAA7C,KAA+D;AACtD,EAAT,OAAS;AAAA,IACL,IADJ,EACU,OAAO,IADjB,KAC2C;AACrC,MAAN,aAAA,CAAoB,eAApB,CAAoC;AAAA,QAC5B,QADR,EACkB;AAAA,UACR;AAAA,YACE,OADZ,EACqB,IADrB,CAC0B,EAD1B,CAC6B,QAD7B,EAAA;AACsC,YAC1B,MADZ,EACoB,IADpB,CACyB,KADzB,CAC+B,QAD/B,EAAA;AACwC,YAC5B,OADZ,EACqB,IADrB,CAC0B,IAD1B,EACgC,KADhC,EAAA,CACwC,QADxC,CACiD,QAAQ,CADzD;AACyD,WAAzD;AACU,SAAV;AACQ,QACA,UADR,EACoB,IADpB,CACyB,GADzB,EAAA,GACiC,CADjC,GACqC,EADrC,GAC0C,GAD1C;AAC0C,OACnC,CADP,CAAA;AACO,KAAP;AACI,IACA,SADJ,EACe,aADf,CAC6B,SAD7B;AAC6B,GAA7B,CAAA;AAEA,CAAC;;;;"}